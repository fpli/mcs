insert into table choco_data.ams_click_diff_tmp_test
select new_click.click_id,new_click.click_dt
FROM (select * from choco_data.ams_click_new_test where click_dt='#{click_dt}' and click_id is not  null) new_click
    FULL outer join (select * from choco_data.ams_click_old_test where click_dt='#{click_dt}' and click_id is not  null) old_click
on  new_click.click_id = old_click.click_id where  !(
    new_click.imprsn_cntnr_id <=>     old_click.imprsn_cntnr_id and
    new_click.file_schm_vrsn_num <=>     old_click.file_schm_vrsn_num and
    new_click.file_id      <=>     old_click.file_id      and
    new_click.batch_id     <=>     old_click.batch_id     and
    new_click.click_id     <=>     old_click.click_id     and
    new_click.chnl_id      <=>     old_click.chnl_id      and
    new_click.crltn_guid_txt <=>     old_click.crltn_guid_txt and
    new_click.guid_txt     <=>     old_click.guid_txt     and
    new_click.user_id      <=>     old_click.user_id      and
    new_click.clnt_rmt_ip  <=>     old_click.clnt_rmt_ip  and
    new_click.brwsr_type_num <=>     old_click.brwsr_type_num and
    new_click.brwsr_name   <=>     old_click.brwsr_name   and
    new_click.rfr_url_name <=>     old_click.rfr_url_name and
    new_click.encryptd_ind <=>     old_click.encryptd_ind and
    new_click.plcmnt_data_txt <=>     old_click.plcmnt_data_txt and
    new_click.pblshr_id    <=>     old_click.pblshr_id    and
    new_click.ams_pblshr_cmpgn_id <=>     old_click.ams_pblshr_cmpgn_id and
    new_click.ams_tool_id  <=>     old_click.ams_tool_id  and
    new_click.cstm_id      <=>     old_click.cstm_id      and
    new_click.lndng_page_url_name <=>     old_click.lndng_page_url_name and
    new_click.user_query_txt <=>     old_click.user_query_txt and
    new_click.flex_fld_vrsn_num <=>     old_click.flex_fld_vrsn_num and
    new_click.flex_fld_1_txt <=>     old_click.flex_fld_1_txt and
    new_click.flex_fld_2_txt <=>     old_click.flex_fld_2_txt and
    new_click.flex_fld_3_txt <=>     old_click.flex_fld_3_txt and
    new_click.flex_fld_4_txt <=>     old_click.flex_fld_4_txt and
    new_click.imprsn_ts    <=>     old_click.imprsn_ts    and
    new_click.click_ts     <=>     old_click.click_ts     and
    new_click.last_vwd_item_id <=>     old_click.last_vwd_item_id and
    new_click.last_vwd_item_ts <=>     old_click.last_vwd_item_ts and
    new_click.last_adn_click_id <=>     old_click.last_adn_click_id and
    new_click.last_adn_click_ts <=>     old_click.last_adn_click_ts and
    new_click.flex_fld_5_txt <=>     old_click.flex_fld_5_txt and
    new_click.flex_fld_6_txt <=>     old_click.flex_fld_6_txt and
    new_click.flex_fld_7_txt <=>     old_click.flex_fld_7_txt and
    new_click.flex_fld_8_txt <=>     old_click.flex_fld_8_txt and
    new_click.flex_fld_9_txt <=>     old_click.flex_fld_9_txt and
    new_click.flex_fld_10_txt <=>     old_click.flex_fld_10_txt and
    new_click.flex_fld_11_txt <=>     old_click.flex_fld_11_txt and
    new_click.flex_fld_12_txt <=>     old_click.flex_fld_12_txt and
    new_click.flex_fld_13_txt <=>     old_click.flex_fld_13_txt and
    new_click.flex_fld_14_txt <=>     old_click.flex_fld_14_txt and
    new_click.flex_fld_15_txt <=>     old_click.flex_fld_15_txt and
    new_click.flex_fld_16_txt <=>     old_click.flex_fld_16_txt and
    new_click.flex_fld_17_txt <=>     old_click.flex_fld_17_txt and
    new_click.flex_fld_18_txt <=>     old_click.flex_fld_18_txt and
    new_click.flex_fld_19_txt <=>     old_click.flex_fld_19_txt and
    new_click.flex_fld_20_txt <=>     old_click.flex_fld_20_txt and
    new_click.icep_flex_fld_vrsn_id <=>     old_click.icep_flex_fld_vrsn_id and
    new_click.icep_flex_fld_1_txt <=>     old_click.icep_flex_fld_1_txt and
    new_click.icep_flex_fld_2_txt <=>     old_click.icep_flex_fld_2_txt and
    new_click.icep_flex_fld_3_txt <=>     old_click.icep_flex_fld_3_txt and
    new_click.icep_flex_fld_4_txt <=>     old_click.icep_flex_fld_4_txt and
    new_click.icep_flex_fld_5_txt <=>     old_click.icep_flex_fld_5_txt and
    new_click.icep_flex_fld_6_txt <=>     old_click.icep_flex_fld_6_txt and
    new_click.ams_prgrm_id <=>     old_click.ams_prgrm_id and
    new_click.advrtsr_id   <=>     old_click.advrtsr_id   and
    new_click.ams_click_fltr_type_id <=>     old_click.ams_click_fltr_type_id and
    new_click.imprsn_loose_match_ind <=>     old_click.imprsn_loose_match_ind and
    new_click.fltr_yn_ind  <=>     old_click.fltr_yn_ind  and
    new_click.ams_trans_rsn_cd <=>     old_click.ams_trans_rsn_cd and
    new_click.ams_page_type_map_id <=>     old_click.ams_page_type_map_id and
    new_click.rfrng_dmn_name <=>     old_click.rfrng_dmn_name and
    new_click.tfs_rfrng_dmn_name <=>     old_click.tfs_rfrng_dmn_name and
    new_click.geo_trgtd_rsn_cd <=>     old_click.geo_trgtd_rsn_cd and
    new_click.src_plcmnt_data_txt <=>     old_click.src_plcmnt_data_txt and
    new_click.geo_trgtd_cntry_cd <=>     old_click.geo_trgtd_cntry_cd and
    new_click.tool_lvl_optn_ind <=>     old_click.tool_lvl_optn_ind and
    new_click.acnt_lvl_optn_ind <=>     old_click.acnt_lvl_optn_ind and
    new_click.geo_trgtd_ind <=>     old_click.geo_trgtd_ind and
    new_click.pblshr_acptd_prgrm_ind <=>     old_click.pblshr_acptd_prgrm_ind and
    new_click.incmng_click_url_vctr_id <=>     old_click.incmng_click_url_vctr_id and
    new_click.str_name_txt <=>     old_click.str_name_txt and
    new_click.item_id      <=>     old_click.item_id      and
    new_click.ctgry_id     <=>     old_click.ctgry_id     and
    new_click.keyword_txt  <=>     old_click.keyword_txt  and
    new_click.prgrm_excptn_list_ind <=>     old_click.prgrm_excptn_list_ind and
    new_click.roi_fltr_yn_ind <=>     old_click.roi_fltr_yn_ind and
    new_click.seller_name  <=>     old_click.seller_name  and
    new_click.rover_url_txt <=>     old_click.rover_url_txt and
    new_click.mplx_timeout_flag <=>     old_click.mplx_timeout_flag and
    new_click.app_id       <=>     old_click.app_id       and
    new_click.app_package_name <=>     old_click.app_package_name and
    new_click.app_name     <=>     old_click.app_name     and
    new_click.app_version  <=>     old_click.app_version  and
    new_click.device_name  <=>     old_click.device_name  and
    new_click.os_name      <=>     old_click.os_name      and
    new_click.os_version   <=>     old_click.os_version   and
    new_click.udid         <=>     old_click.udid         and
    new_click.sdk_name     <=>     old_click.sdk_name     and
    new_click.sdk_version  <=>     old_click.sdk_version  and
    new_click.trfc_src_cd  <=>     old_click.trfc_src_cd  and
    new_click.roi_rule_values <=>     old_click.roi_rule_values and
    new_click.rt_rule_flag1 <=>     old_click.rt_rule_flag1 and
    new_click.rt_rule_flag2 <=>     old_click.rt_rule_flag2 and
    new_click.rt_rule_flag3 <=>     old_click.rt_rule_flag3 and
    new_click.rt_rule_flag4 <=>     old_click.rt_rule_flag4 and
    new_click.rt_rule_flag5 <=>     old_click.rt_rule_flag5 and
    new_click.rt_rule_flag6 <=>     old_click.rt_rule_flag6 and
    new_click.rt_rule_flag7 <=>     old_click.rt_rule_flag7 and
    new_click.rt_rule_flag8 <=>     old_click.rt_rule_flag8 and
    new_click.rt_rule_flag9 <=>     old_click.rt_rule_flag9 and
    new_click.rt_rule_flag10 <=>     old_click.rt_rule_flag10 and
    new_click.rt_rule_flag11 <=>     old_click.rt_rule_flag11 and
    new_click.rt_rule_flag12 <=>     old_click.rt_rule_flag12 and
    new_click.rt_rule_flag13 <=>     old_click.rt_rule_flag13 and
    new_click.rt_rule_flag14 <=>     old_click.rt_rule_flag14 and
    new_click.rt_rule_flag15 <=>     old_click.rt_rule_flag15 and
    new_click.rt_rule_flag16 <=>     old_click.rt_rule_flag16 and
    new_click.rt_rule_flag17 <=>     old_click.rt_rule_flag17 and
    new_click.rt_rule_flag18 <=>     old_click.rt_rule_flag18 and
    new_click.rt_rule_flag19 <=>     old_click.rt_rule_flag19 and
    new_click.rt_rule_flag20 <=>     old_click.rt_rule_flag20 and
    new_click.rt_rule_flag21 <=>     old_click.rt_rule_flag21 and
    new_click.rt_rule_flag22 <=>     old_click.rt_rule_flag22 and
    new_click.rt_rule_flag23 <=>     old_click.rt_rule_flag23 and
    new_click.rt_rule_flag24 <=>     old_click.rt_rule_flag24 and
    new_click.nrt_rule_flag1 <=>     old_click.nrt_rule_flag1 and
    new_click.nrt_rule_flag2 <=>     old_click.nrt_rule_flag2 and
    new_click.nrt_rule_flag3 <=>     old_click.nrt_rule_flag3 and
    new_click.nrt_rule_flag4 <=>     old_click.nrt_rule_flag4 and
    new_click.nrt_rule_flag5 <=>     old_click.nrt_rule_flag5 and
    new_click.nrt_rule_flag6 <=>     old_click.nrt_rule_flag6 and
    new_click.nrt_rule_flag7 <=>     old_click.nrt_rule_flag7 and
    new_click.nrt_rule_flag8 <=>     old_click.nrt_rule_flag8 and
    new_click.nrt_rule_flag9 <=>     old_click.nrt_rule_flag9 and
    new_click.nrt_rule_flag10 <=>     old_click.nrt_rule_flag10 and
    new_click.nrt_rule_flag11 <=>     old_click.nrt_rule_flag11 and
    new_click.nrt_rule_flag12 <=>     old_click.nrt_rule_flag12 and
    new_click.nrt_rule_flag13 <=>     old_click.nrt_rule_flag13 and
    new_click.nrt_rule_flag14 <=>     old_click.nrt_rule_flag14 and
    new_click.nrt_rule_flag15 <=>     old_click.nrt_rule_flag15 and
    new_click.nrt_rule_flag16 <=>     old_click.nrt_rule_flag16 and
    new_click.nrt_rule_flag17 <=>     old_click.nrt_rule_flag17 and
    new_click.nrt_rule_flag18 <=>     old_click.nrt_rule_flag18 and
    new_click.nrt_rule_flag19 <=>     old_click.nrt_rule_flag19 and
    new_click.nrt_rule_flag20 <=>     old_click.nrt_rule_flag20 and
    new_click.nrt_rule_flag21 <=>     old_click.nrt_rule_flag21 and
    new_click.nrt_rule_flag22 <=>     old_click.nrt_rule_flag22 and
    new_click.nrt_rule_flag23 <=>     old_click.nrt_rule_flag23 and
    new_click.nrt_rule_flag24 <=>     old_click.nrt_rule_flag24 and
    new_click.nrt_rule_flag25 <=>     old_click.nrt_rule_flag25 and
    new_click.nrt_rule_flag26 <=>     old_click.nrt_rule_flag26 and
    new_click.nrt_rule_flag27 <=>     old_click.nrt_rule_flag27 and
    new_click.nrt_rule_flag28 <=>     old_click.nrt_rule_flag28 and
    new_click.nrt_rule_flag29 <=>     old_click.nrt_rule_flag29 and
    new_click.nrt_rule_flag30 <=>     old_click.nrt_rule_flag30 and
    new_click.nrt_rule_flag31 <=>     old_click.nrt_rule_flag31 and
    new_click.nrt_rule_flag32 <=>     old_click.nrt_rule_flag32 and
    new_click.nrt_rule_flag33 <=>     old_click.nrt_rule_flag33 and
    new_click.nrt_rule_flag34 <=>     old_click.nrt_rule_flag34 and
    new_click.nrt_rule_flag35 <=>     old_click.nrt_rule_flag35 and
    new_click.nrt_rule_flag36 <=>     old_click.nrt_rule_flag36 and
    new_click.nrt_rule_flag37 <=>     old_click.nrt_rule_flag37 and
    new_click.nrt_rule_flag38 <=>     old_click.nrt_rule_flag38 and
    new_click.nrt_rule_flag39 <=>     old_click.nrt_rule_flag39 and
    new_click.nrt_rule_flag40 <=>     old_click.nrt_rule_flag40 and
    new_click.nrt_rule_flag41 <=>     old_click.nrt_rule_flag41 and
    new_click.nrt_rule_flag42 <=>     old_click.nrt_rule_flag42 and
    new_click.nrt_rule_flag43 <=>     old_click.nrt_rule_flag43 and
    new_click.nrt_rule_flag44 <=>     old_click.nrt_rule_flag44 and
    new_click.nrt_rule_flag45 <=>     old_click.nrt_rule_flag45 and
    new_click.nrt_rule_flag46 <=>     old_click.nrt_rule_flag46 and
    new_click.nrt_rule_flag47 <=>     old_click.nrt_rule_flag47 and
    new_click.nrt_rule_flag48 <=>     old_click.nrt_rule_flag48 and
    new_click.nrt_rule_flag49 <=>     old_click.nrt_rule_flag49 and
    new_click.nrt_rule_flag50 <=>     old_click.nrt_rule_flag50 and
    new_click.nrt_rule_flag51 <=>     old_click.nrt_rule_flag51 and
    new_click.nrt_rule_flag52 <=>     old_click.nrt_rule_flag52 and
    new_click.nrt_rule_flag53 <=>     old_click.nrt_rule_flag53 and
    new_click.nrt_rule_flag54 <=>     old_click.nrt_rule_flag54 and
    new_click.nrt_rule_flag55 <=>     old_click.nrt_rule_flag55 and
    new_click.nrt_rule_flag56 <=>     old_click.nrt_rule_flag56 and
    new_click.nrt_rule_flag57 <=>     old_click.nrt_rule_flag57 and
    new_click.nrt_rule_flag58 <=>     old_click.nrt_rule_flag58 and
    new_click.nrt_rule_flag59 <=>     old_click.nrt_rule_flag59 and
    new_click.nrt_rule_flag60 <=>     old_click.nrt_rule_flag60 and
    new_click.nrt_rule_flag61 <=>     old_click.nrt_rule_flag61 and
    new_click.nrt_rule_flag62 <=>     old_click.nrt_rule_flag62 and
    new_click.nrt_rule_flag63 <=>     old_click.nrt_rule_flag63 and
    new_click.nrt_rule_flag64 <=>     old_click.nrt_rule_flag64 and
    new_click.nrt_rule_flag65 <=>     old_click.nrt_rule_flag65 and
    new_click.nrt_rule_flag66 <=>     old_click.nrt_rule_flag66 and
    new_click.nrt_rule_flag67 <=>     old_click.nrt_rule_flag67 and
    new_click.nrt_rule_flag68 <=>     old_click.nrt_rule_flag68 and
    new_click.nrt_rule_flag69 <=>     old_click.nrt_rule_flag69 and
    new_click.nrt_rule_flag70 <=>     old_click.nrt_rule_flag70 and
    new_click.nrt_rule_flag71 <=>     old_click.nrt_rule_flag71 and
    new_click.nrt_rule_flag72 <=>     old_click.nrt_rule_flag72 and
    new_click.nrt_rule_flag73 <=>     old_click.nrt_rule_flag73 and
    new_click.nrt_rule_flag74 <=>     old_click.nrt_rule_flag74 and
    new_click.nrt_rule_flag75 <=>     old_click.nrt_rule_flag75 and
    new_click.nrt_rule_flag76 <=>     old_click.nrt_rule_flag76 and
    new_click.nrt_rule_flag77 <=>     old_click.nrt_rule_flag77 and
    new_click.nrt_rule_flag78 <=>     old_click.nrt_rule_flag78 and
    new_click.nrt_rule_flag79 <=>     old_click.nrt_rule_flag79 and
    new_click.nrt_rule_flag80 <=>     old_click.nrt_rule_flag80 and
    new_click.click_id is not null and old_click.click_id is not null)
UNION
select null as click_id,'#{click_dt}' as click_dt
where (select count(*) as count from choco_data.ams_click_new_test where click_dt='#{click_dt}' and click_id is null) <>
      (select count(*) as count from choco_data.ams_click_old_test where click_dt='#{click_dt}' and click_id is null)