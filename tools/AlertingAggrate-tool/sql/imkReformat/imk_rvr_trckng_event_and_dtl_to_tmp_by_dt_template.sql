insert into table choco_data.imk_rvr_trckng_event_tmp
select imk.batch_id,
       imk.file_id,
       imk.file_schm_vrsn,
       imk.rvr_id,
       imk.srvd_pstn,
       imk.rvr_cmnd_type_cd,
       imk.rvr_chnl_type_cd,
       imk.cntry_cd,
       imk.lang_cd,
       imk.trckng_prtnr_id,
       imk.cguid,
       imk.guid,
       imk.user_id,
       imk.clnt_remote_ip,
       imk.brwsr_type_id,
       imk.brwsr_name,
       imk.rfrr_dmn_name,
       imk.rfrr_url,
       imk.url_encrptd_yn_ind,
       imk.pblshr_id,
       imk.lndng_page_dmn_name,
       imk.lndng_page_url,
       imk.user_query,
       imk.rule_bit_flag_strng,
       imk.event_ts,
       imk.dflt_bhrv_id,
       imk.src_rotation_id,
       imk.dst_rotation_id,
       imk.user_map_ind,
       imk.dst_client_id,
       imk.creative_id,
       imk.test_ctrl_flag,
       imk.mfe_id,
       imk.kw_id,
       imk.keyword,
       imk.mt_id,
       imk.crlp,
       imk.geo_id,
       imk.item_id,
       imk.transaction_type,
       imk.transaction_id,
       imk.cart_id,
       imk.extrnl_cookie,
       imk.ebay_site_id,
       imk.rvr_url,
       dtl.flex_field_vrsn_num,
       dtl.flex_field_1,
       dtl.flex_field_2,
       dtl.flex_field_3,
       dtl.flex_field_4,
       dtl.flex_field_5,
       dtl.flex_field_6,
       dtl.flex_field_7,
       dtl.flex_field_8,
       dtl.flex_field_9,
       dtl.flex_field_10,
       dtl.flex_field_11,
       dtl.flex_field_12,
       dtl.flex_field_13,
       dtl.flex_field_14,
       dtl.flex_field_15,
       dtl.flex_field_16,
       dtl.flex_field_17,
       dtl.flex_field_18,
       dtl.flex_field_19,
       dtl.flex_field_20,
       dtl.perf_track_name_value,
       imk.cre_date,
       imk.cre_user,
       imk.upd_date,
       imk.upd_user
from (select distinct * from choco_data.imk_rvr_trckng_event where dt='#{dt}') imk
left outer join (select distinct * from choco_data.imk_rvr_trckng_event_dtl where dt='#{dt}') dtl
on imk.rvr_id=dtl.rvr_id  and imk.event_ts=dtl.event_ts